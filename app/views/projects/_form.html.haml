.project
  = simple_form_for @project do |f|
    - if @project.errors.any?
      .show-alert
        .alert.alert-danger
          %span
            %strong Oops!
            Có #{@project.errors.count} lỗi
        %ul.errors
          - @project.errors.full_messages.each_with_index do |msg, index|
            %li
              %strong #{index}.
              = msg
    #project-img
      .img-upload.col-md-3
        %span.plus +
        %span.upload-text
          = f.file_field :photo
          = f.hidden_field :photo_cache
          = f.input :user_id, :as => :hidden, :input_html => {:value => current_user.id}
        %span.img-upload-size 600 x 300 px
      .img-uploaded.col-md-6
        %span
          = image_tag(@project.photo_url(:banner), class: "uploaded-img center-block") if @project.photo?
    #forms
      / Tên Dự Án
      .form-item
        %label{for: "Tên Dự Án"} Tên Dự Án
        %span.example
          Ví Dụ
          %i Ấm Tình Mùa Xuân
        = f.input :title, label: false, :input_html => {:class => "form-control"}
      / Giới Thiệu Sơ Lược
      .form-item
        %label{for: "Giới Thiệu Sơ Lược"} Giới Thiệu Sơ Lược
        %span.example Viết ngắn gọn về dự án của bạn, tối đa 200 kí tự
        = f.input :brief, label: false, :input_html => {:class => "form-control brief", :size => "50x5"}
        %span.length
          Còn lại
          %strong.brief-length 187
          kí tự
      / Giới Thiệu Chi Tiết
      .form-item.row
        .col-md-7
          %label{for: "Giới Thiệu Chi Tiết"} Giới Thiệu Chi Tiết
          %span.example Chi tiết các thông tin về dự án của bạn
          = f.input :description, label: false, :input_html => {:class => "span12 editable form-control", :size => "50x20"}
          .gift-check
            %label Dự án của bạn có vật phẩm tặng kèm?
            = f.check_box :item_based
        .col-md-5
          %table.table
            %thead
              %tr
                %th
                  Nhập
                %th
                  Hiển Thị
            %tbody
              %tr
                %td
                  **In Đậm**
                %td
                  %strong In Đậm
              %tr
                %td
                  *In Nghiêng*
                %td
                  %i In Nghiêng
              %tr
                %td
                  \![Đây là ảnh con Minion](http://imgur.com/1waoU4j.png)
                %td
                  %img{alt: "Đây là ảnh con Minion", src: "http://imgur.com/1waoU4j.png"}/
              %tr
                %td
                  [Link tới Google](http://www.google.com)
                %td
                  %a{href: "http://www.google.com"} Link tới Google
      .alert.alert-info
        %strong Hướng dẫn định dạng văn bản chi tiết
        %p Bản Đồ Từ Thiện (Charity Map) là trang web gây quỹ cộng đồng dành cho các dự án xã hội tại Việt Nam. Chúng tôi đặt tính minh bạch và sự tín nhiệm làm tiêu chí hoạt động.
      / Clip Giới Thiệu Dự Án
      .form-item
        %label{for: "Clip Giới Thiệu Dự Án"} Clip Giới Thiệu Dự Án
        %span.example
          Ví dụ
          %i http://www.youtube.com/watch?v=m5yCOSHeYn4
        = f.input :video, label: false, :input_html => {:class => "form-control"}
      / Tài Khoản Ngân Hàng
      .form-item
        %label{for: "Tài Khoản Ngân Hàng"} Tài Khoản Ngân Hàng
        %span.example Hãy điền đầy đủ các thông tin bên dưới
        .clearfix
        %form.form-inline.row
          .form-group.col-md-2
            %input.form-control.col-md-2{placeholder: "Ngân Hàng", type: "text"}/
          .form-group.col-md-2
            %input.form-control{placeholder: "Chi Nhánh", type: "text"}/
          .form-group.col-md-2
            %input.form-control{placeholder: "Địa Chỉ", type: "text"}/
          .form-group.col-md-2
            %input.form-control{placeholder: "SWIFT CODE", type: "text"}/
          .form-group.col-md-2
            %input.form-control{placeholder: "Chủ Tài Khoản", type: "text"}/
          .form-group.col-md-2
            %input.form-control{placeholder: "Số Tài Khoản", type: "text"}/
      / Mục Tiêu Gây Quỹ
      .form-item.goal
        %label{for: "Mục Tiêu Gây Quỹ"} Mục Tiêu Gây Quỹ
        %span.example Mục tiêu, thời gian & địa điểm gây quỹ
        .clearfix
        %form.form-inline.row
          .form-group.col-md-3
            = f.input :start_date, label: false, :as => :string, :input_html => {:class => "form-control start_date", placeholder: "Start Date"}
          .form-group.col-md-3
            = f.input :end_date, label: false,   :as => :string, :input_html => {:class => "form-control end_date", placeholder: "End Date"}
          .form-group.col-md-3
            = f.input :funding_goal, label: false, :input_html => {:class => "form-control", placeholder: "Funding Goal"}
          .form-group.col-md-3
            = f.input :location, label: false, placeholder: "Địa Điểm", :input_html => {:class => "form-control", placeholder: "Location"}
      %hr/ 
      - if params[:controller] == "projects" && params[:action] == "edit"
        = link_to project_path(@project) do
          %button.btn.btn-danger.cancel-prj{type: "button"} Hủy
        = link_to submit_project_path(id: @project.id) do
          %button.btn.btn-success.save-prj{type: "button"} Chuyển sang trạng thái gây quỹ
      - else
        = link_to dashboard_path do
          %button.btn.btn-danger.cancel-prj{type: "button"} Hủy
      = f.submit "Lưu", class: "submit btn btn-success save-prj"      

:javascript
  $( document ).ready(function() {
    $(".start_date").datepicker({
      defaultDate: "+1w",
      changeMonth: true,
      dateFormat: 'yy-mm-dd',
      onClose: function( selectedDate ) {
        $( ".end_date" ).datepicker( "option", "minDate", selectedDate );
      }
    });
    $(".end_date").datepicker({
      defaultDate: "+1w",
      changeMonth: true,
      dateFormat: 'yy-mm-dd',
      onClose: function( selectedDate ) {
        $(".start_date").datepicker( "option", "maxDate", selectedDate );
      }
    });
    $(".start_date").click(function(){
      $(".start_date").datepicker();
    });
    $(".end_date").click(function(){
      $(".end_date").datepicker();
    });

    $('.project .brief').keyup(function () {
      $('.project .brief-length').css('display', 'block');
      var max = 200;
      var min = 20;
      var len = $(this).val().length;
      if (len >= max) {
        $('.project .brief-length').text('Tối đa 200 ký tự.');
      } else {
        var char = max - len;
        $('.project .brief-length').text('Còn ' + char + ' ký tự');
      }
    });
  });
