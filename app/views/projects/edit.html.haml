.body-container--plain-row
  .body-container--content
    %h1 Editing project
    = link_to 'Show', @project
    %hr/ 

    = render 'form'

    %hr/
    .headline Rewards
    .project_rewards
      - @project.project_rewards.each do |reward|
        %p
          - reward.attributes.each do |key, value|
            %b= key.humanize
            = value
            |
    
    = simple_form_for [@project, @project_reward], remote: true do |f|
      - if @project_reward.errors.any?
        #error_explanation
          %h2= "#{pluralize(@project_reward.errors.count, "error")} prohibited this project from being saved:"
          %ul
            - @project_reward.errors.full_messages.each do |msg|
              %li= msg
      
      = f.input       :project_id, :as => :hidden, :input_html => {:value => @project.id}
      = f.input       :amount
      = f.input       :description
      = f.submit "Lưu"
    = link_to 'Thêm Mốc Tài Trợ', new_project_project_reward_path(@project)

    %hr/
    .headline Cập Nhật Dự Án (sẽ được email tới MTQ)

    - @project.project_updates.each do |update|
      %p
        - update.attributes.each do |key, value|
          %b= key.humanize
          = value
          |
    
    = link_to 'Thêm Cập Nhật', new_project_project_update_path(@project)

    %hr/ 
    - if @project.status == "DRAFT"
      .headline Hoan thanh
      = link_to "Gui xet duyet", projects_submit_path(id: @project.id)

:javascript
  $(document).ready(function() {
    return $("#new_project_reward").bind("ajax:success", function(data, status, xhr) {
      var str;
      str = "";
      $.each(status, function(key, value) {
        return str = str + "<b>" + key + ":</b>" + " " + value + " | ";
      });
      return $(".project_rewards").append(str + "</br>");
    }).bind("ajax:failure", function(xhr, status, error) {
      return alert("Action failed.");
    });
  });
